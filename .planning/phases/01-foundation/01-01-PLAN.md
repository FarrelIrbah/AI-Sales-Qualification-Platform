---
phase: 01-foundation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - package.json
  - next.config.ts
  - tsconfig.json
  - postcss.config.mjs
  - src/app/globals.css
  - src/app/layout.tsx
  - src/app/page.tsx
  - src/lib/supabase/client.ts
  - src/lib/supabase/server.ts
  - src/proxy.ts
  - .env.local.example
  - components.json
autonomous: true

must_haves:
  truths:
    - "Next.js dev server starts without errors"
    - "Tailwind CSS styles are applied correctly"
    - "shadcn/ui components are available for use"
    - "Supabase client can be imported in browser and server contexts"
  artifacts:
    - path: "package.json"
      provides: "Project dependencies and scripts"
      contains: "next"
    - path: "src/lib/supabase/client.ts"
      provides: "Browser Supabase client"
      exports: ["createClient"]
    - path: "src/lib/supabase/server.ts"
      provides: "Server Supabase client"
      exports: ["createClient"]
    - path: "src/proxy.ts"
      provides: "Session refresh proxy"
      exports: ["proxy", "config"]
  key_links:
    - from: "src/app/layout.tsx"
      to: "src/app/globals.css"
      via: "CSS import"
      pattern: "import.*globals.css"
    - from: "src/proxy.ts"
      to: "@supabase/ssr"
      via: "createServerClient"
      pattern: "createServerClient"
---

<objective>
Scaffold the Next.js 16 project with Supabase integration, Tailwind CSS 4, and shadcn/ui.

Purpose: Establish the foundational project structure that all subsequent plans depend on.
Output: Working Next.js dev environment with Supabase clients configured and UI framework ready.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-foundation/01-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Initialize Next.js 16 project with dependencies</name>
  <files>
    - package.json
    - next.config.ts
    - tsconfig.json
    - postcss.config.mjs
    - src/app/globals.css
    - src/app/layout.tsx
    - src/app/page.tsx
  </files>
  <action>
Create a new Next.js 16 project using `npx create-next-app@latest . --typescript --tailwind --app --src-dir --import-alias "@/*"` (use `--yes` to accept defaults, answer "no" to Turbopack if prompted since it's now default).

After project creation, install additional dependencies:
```bash
npm install @supabase/supabase-js @supabase/ssr
npm install drizzle-orm postgres
npm install react-hook-form zod @hookform/resolvers
npm install -D drizzle-kit @types/node
```

Update `src/app/globals.css` to use Tailwind CSS 4 syntax:
```css
@import "tailwindcss";
```

Update `src/app/page.tsx` to a minimal placeholder that confirms the stack is working:
```tsx
export default function Home() {
  return (
    <main className="flex min-h-screen flex-col items-center justify-center p-24">
      <h1 className="text-4xl font-bold">LeadQual</h1>
      <p className="mt-4 text-muted-foreground">Foundation setup complete</p>
    </main>
  )
}
```

Ensure `next.config.ts` exists (Next.js 16 uses .ts by default).
  </action>
  <verify>
Run `npm run dev` and verify the dev server starts on localhost:3000 without errors. Visit the page and confirm "LeadQual" heading is visible with Tailwind styling applied.
  </verify>
  <done>
Next.js 16 project runs with Tailwind CSS 4 styling visible on the home page.
  </done>
</task>

<task type="auto">
  <name>Task 2: Configure Supabase clients and proxy</name>
  <files>
    - src/lib/supabase/client.ts
    - src/lib/supabase/server.ts
    - src/proxy.ts
    - .env.local.example
  </files>
  <action>
Create Supabase client files following the patterns from research:

**src/lib/supabase/client.ts** (browser client):
```typescript
import { createBrowserClient } from '@supabase/ssr'

export function createClient() {
  return createBrowserClient(
    process.env.NEXT_PUBLIC_SUPABASE_URL!,
    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!
  )
}
```

**src/lib/supabase/server.ts** (server client):
```typescript
import { createServerClient } from '@supabase/ssr'
import { cookies } from 'next/headers'

export async function createClient() {
  const cookieStore = await cookies()

  return createServerClient(
    process.env.NEXT_PUBLIC_SUPABASE_URL!,
    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!,
    {
      cookies: {
        getAll() {
          return cookieStore.getAll()
        },
        setAll(cookiesToSet) {
          try {
            cookiesToSet.forEach(({ name, value, options }) =>
              cookieStore.set(name, value, options)
            )
          } catch {
            // Ignore - handled by proxy
          }
        },
      },
    }
  )
}
```

**src/proxy.ts** (Next.js 16 proxy for session refresh):
```typescript
import { type NextRequest, NextResponse } from 'next/server'
import { createServerClient } from '@supabase/ssr'

export async function proxy(request: NextRequest) {
  let response = NextResponse.next({
    request: {
      headers: request.headers,
    },
  })

  const supabase = createServerClient(
    process.env.NEXT_PUBLIC_SUPABASE_URL!,
    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!,
    {
      cookies: {
        getAll() {
          return request.cookies.getAll()
        },
        setAll(cookiesToSet) {
          cookiesToSet.forEach(({ name, value }) =>
            request.cookies.set(name, value)
          )
          response = NextResponse.next({
            request: {
              headers: request.headers,
            },
          })
          cookiesToSet.forEach(({ name, value, options }) =>
            response.cookies.set(name, value, options)
          )
        },
      },
    }
  )

  // Refresh session using getClaims() for validation
  await supabase.auth.getUser()

  return response
}

export const config = {
  matcher: [
    '/((?!_next/static|_next/image|favicon.ico|.*\\.(?:svg|png|jpg|jpeg|gif|webp)$).*)',
  ],
}
```

**.env.local.example**:
```
# Supabase - Get from Supabase Dashboard > Settings > API
NEXT_PUBLIC_SUPABASE_URL=https://your-project.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=your-anon-key

# Database - Get from Supabase Dashboard > Settings > Database > Connection string (pooler)
DATABASE_URL=postgresql://postgres.xxx:password@aws-0-region.pooler.supabase.com:6543/postgres
```

Note: Use NEXT_PUBLIC_SUPABASE_ANON_KEY (not PUBLISHABLE_KEY as in some docs - anon_key is the standard Supabase naming).
  </action>
  <verify>
Run `npm run dev` and confirm no TypeScript errors. Import the client in a test: add `import { createClient } from '@/lib/supabase/client'` to page.tsx temporarily and confirm no build errors.
  </verify>
  <done>
Supabase clients created for browser and server contexts. Proxy configured for session refresh. Environment variable example file created.
  </done>
</task>

<task type="auto">
  <name>Task 3: Initialize shadcn/ui with core components</name>
  <files>
    - components.json
    - src/components/ui/button.tsx
    - src/components/ui/input.tsx
    - src/components/ui/label.tsx
    - src/components/ui/card.tsx
    - src/components/ui/form.tsx
    - src/lib/utils.ts
  </files>
  <action>
Initialize shadcn/ui with the project:
```bash
npx shadcn@latest init
```

When prompted:
- Style: Default
- Base color: Neutral (or Zinc)
- CSS variables: Yes

Install core components needed for auth forms:
```bash
npx shadcn@latest add button input label card form separator
```

Verify `components.json` is created with correct paths pointing to `src/components/ui` and `src/lib/utils.ts`.

Update `src/app/page.tsx` to use a shadcn button to confirm components work:
```tsx
import { Button } from "@/components/ui/button"

export default function Home() {
  return (
    <main className="flex min-h-screen flex-col items-center justify-center p-24">
      <h1 className="text-4xl font-bold">LeadQual</h1>
      <p className="mt-4 text-muted-foreground">Foundation setup complete</p>
      <Button className="mt-6">Get Started</Button>
    </main>
  )
}
```
  </action>
  <verify>
Run `npm run dev` and visit localhost:3000. Confirm the "Get Started" button renders with proper shadcn/ui styling (rounded corners, proper colors, hover effects).
  </verify>
  <done>
shadcn/ui initialized with button, input, label, card, form, and separator components. Components render correctly in the UI.
  </done>
</task>

</tasks>

<verification>
Run these checks to verify plan completion:

1. `npm run dev` starts without errors
2. `npm run build` completes without TypeScript errors
3. Home page shows styled content at localhost:3000
4. shadcn Button component renders with proper styling
5. No console errors in browser
</verification>

<success_criteria>
- Next.js 16 dev server runs successfully
- Tailwind CSS 4 styles apply correctly
- Supabase client files exist and import without errors
- shadcn/ui components render properly
- proxy.ts is configured for session refresh
- .env.local.example documents required environment variables
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation/01-01-SUMMARY.md`
</output>
